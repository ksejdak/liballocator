<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>liballocator: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">liballocator
   &#160;<span id="projectnumber">1.0.4</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">liballocator Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://github.com/kubasejdak/liballocator/releases"></a> <a href="https://travis-ci.org/kubasejdak/liballocator"></a> <a href="https://opensource.org/licenses/BSD-2-Clause"></a> <a href="http://codecov.io/github/kubasejdak/liballocator?branch=master"></a></p>
<h1>liballocator</h1>
<p>The purpose of this project is to provide a convenient and fairly robust memory allocator for the embedded environments in C++. It is based on the FreeBSD's <a href="https://www.freebsd.org/cgi/man.cgi?query=uma&amp;sektion=9&amp;manpath=freebsd-release-ports">UMA (Universal Memory Allocator)</a> called the zone allocator and some concepts taken from <a href="https://en.wikipedia.org/wiki/Slab_allocation">SLAB allocator</a>.</p>
<h2>Requirements</h2>
<p>Embedded systems have very specific requirements regarding memory allocation. Here is the list of issues/features, that liballocator is trying to address:</p>
<ul>
<li>physical memory can be split into multiple continuous spaces,</li>
<li>boundaries of physical memory space can be specified either by linker script or by programmer in code,</li>
<li>allocated memory chunks should be aligned to it's size,</li>
<li>client should be able to overload operator new() to use liballocator,</li>
<li>allocator should be usable in systems with MMU, MPU or without memory protection,</li>
<li>there should be low bookkeeping overhead,</li>
<li>memory shouldn't be subject to fragmentation.</li>
</ul>
<h2>Overview</h2>
<p>liballocator consists of two parts:</p>
<ul>
<li>page allocator - responsible for managing and allocation of the physical pages. This module is aware of the number of continuous regions (SRAM, DDR RAM, etc).</li>
<li>zone allocator - responsible for allocation of the size-aligned memory chunks. This module makes use of the page allocator to create the zones containing chunks of the same size.</li>
</ul>
<h2>Requirements</h2>
<ul>
<li>CMake v3.9+,</li>
<li>GCC/Clang with C++17 support,</li>
<li>Linux/macOS (not tested on Windows).</li>
</ul>
<h2>Usage</h2>
<p>To use liballocator in your CMake project all you need to do is:</p>
<ul>
<li>Download this repository into your project (IMPORTANT: liballocator contains git submodules): <div class="fragment"><div class="line">git clone --recurse-submodules git@github.com:kubasejdak/liballocator.git   # Since Git 2.13</div><div class="line">git clone --recursive git@github.com:kubasejdak/liballocator.git            # Before Git 2.13</div></div><!-- fragment --></li>
<li>Add it to CMake with: <div class="fragment"><div class="line">add_subdirectory(liballocator)</div></div><!-- fragment --></li>
<li>Link liballocator with your target: <div class="fragment"><div class="line">target_link_libraries(&lt;YOUR_TARGET&gt; PUBLIC liballocator)</div></div><!-- fragment --></li>
</ul>
<p>If you use concepts of "Modern CMake", then all necessary flags and include paths to build and use liballocator will be automatically propagated. Check out this example project with STM32F4DISCOVERY: <a href="https://github.com/kubasejdak/liballocator-demo">liballocator-demo</a>.</p>
<h2>Performance</h2>
<p>Tests were performed on macOS Mojave 10.14, Macbook Pro (2,9 GHz Intel Core i5, 8 GB 2133 MHz LPDDR3).</p>
<p>NOTE: liballocator currently does not contain any optimizations, assembly or caches. Performance tests do not take into account the design goals of any used allocator. Results shown below are only for illustrative purposes and should not be used as a reference of any kind.</p>
<h5>Allocate 1000000x 134 bytes</h5>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Allocator  </th><th class="markdownTableHeadCenter">Allocate (g++ 8.2.0)  </th><th class="markdownTableHeadCenter" colspan="3">Rel   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">liballocator  </td><td class="markdownTableBodyCenter">3.0761 us  </td><td class="markdownTableBodyCenter">3.1229 us  </td><td class="markdownTableBodyCenter">2.2062 us  </td><td class="markdownTableBodyCenter">2.2090 us   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">malloc  </td><td class="markdownTableBodyCenter">0.0303 us  </td><td class="markdownTableBodyCenter">0.0296 us  </td><td class="markdownTableBodyCenter">0.0008 us  </td><td class="markdownTableBodyCenter">0.0010 us   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">new  </td><td class="markdownTableBodyCenter">0.0833 us  </td><td class="markdownTableBodyCenter">0.0733 us  </td><td class="markdownTableBodyCenter">0.0008 us  </td><td class="markdownTableBodyCenter">0.0009 us   </td></tr>
</table>
<h5>Allocate 1000000x 4056 bytes</h5>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Allocator  </th><th class="markdownTableHeadCenter">Allocate (g++ 8.2.0)  </th><th class="markdownTableHeadCenter" colspan="3">Rel   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">liballocator  </td><td class="markdownTableBodyCenter">2.9269 us  </td><td class="markdownTableBodyCenter">3.0897 us  </td><td class="markdownTableBodyCenter">2.0906 us  </td><td class="markdownTableBodyCenter">2.1194 us   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">malloc  </td><td class="markdownTableBodyCenter">0.0300 us  </td><td class="markdownTableBodyCenter">0.0297 us  </td><td class="markdownTableBodyCenter">0.0008 us  </td><td class="markdownTableBodyCenter">0.0006 us   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">new  </td><td class="markdownTableBodyCenter">0.0832 us  </td><td class="markdownTableBodyCenter">0.0781 us  </td><td class="markdownTableBodyCenter">0.0012 us  </td><td class="markdownTableBodyCenter">0.0008 us   </td></tr>
</table>
<h5>Allocate 2000x random number of bytes</h5>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Allocator  </th><th class="markdownTableHeadCenter">Allocate (g++ 8.2.0)  </th><th class="markdownTableHeadCenter" colspan="3">Rel   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">liballocator  </td><td class="markdownTableBodyCenter">16.0200 us  </td><td class="markdownTableBodyCenter">10.8960 us  </td><td class="markdownTableBodyCenter">14.8775 us  </td><td class="markdownTableBodyCenter">9.9780 us   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">malloc  </td><td class="markdownTableBodyCenter">0.1600 us  </td><td class="markdownTableBodyCenter">0.2660 us  </td><td class="markdownTableBodyCenter">0.0600 us  </td><td class="markdownTableBodyCenter">0.0850 us   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">new  </td><td class="markdownTableBodyCenter">0.0980 us  </td><td class="markdownTableBodyCenter">0.2055 us  </td><td class="markdownTableBodyCenter">0.0020 us  </td><td class="markdownTableBodyCenter">0.0680 us   </td></tr>
</table>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
